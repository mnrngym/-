<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>宗教相性診断フォーム（50問）</title>
  <style>
    :root{
      --bg:#0b0f14; --panel:#111720; --ink:#ecf1f8; --muted:#9fb1c7; --accent:#5cc8ff;
      --line:#1d2633; --btn:#121a26;
    }
    *{box-sizing:border-box}
    body{margin:0; background:var(--bg); color:var(--ink); font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN",Meiryo,sans-serif}
    header{position:sticky; top:0; z-index:10; backdrop-filter:blur(8px); background:linear-gradient(180deg,rgba(11,15,20,.9),rgba(11,15,20,.6)); border-bottom:1px solid var(--line)}
    .wrap{max-width:980px; margin:0 auto; padding:16px}
    h1{font-size:clamp(28px,6vw,40px); margin:8px 0 4px; font-weight:800}
    p.lead{color:var(--muted)}
    .card{background:var(--panel); border:1px solid var(--line); border-radius:16px; padding:16px; box-shadow:0 6px 24px rgba(0,0,0,.25); margin-top:12px}
    .row{display:grid; grid-template-columns:240px 1fr; gap:8px; align-items:center}
    input[type="text"]{width:100%; padding:10px 12px; border-radius:10px; border:1px solid #223049; background:#0f1621; color:var(--ink)}
    .grid{display:grid; grid-template-columns:1fr; gap:12px}
    @media(min-width:900px){.grid{grid-template-columns:1fr 1fr}}
    .q{padding:12px; border-radius:12px; border:1px solid var(--line); background:#0f1621}
    .q h4{margin:0 0 8px; font-size:15px; line-height:1.45}
    select{width:100%; padding:10px 12px; border-radius:10px; border:1px solid #223049; background:#0f1621; color:var(--ink)}
    .actions{display:flex; gap:8px; flex-wrap:wrap}
    .btn{padding:12px 16px; border-radius:12px; border:1px solid var(--line); background:var(--btn); color:var(--ink); cursor:pointer}
    .btn.primary{border-color:var(--accent)}
    /* thanks view */
    #thanks{display:none; min-height:100vh; background:#fff; color:#111}
    #thanks .center{max-width:680px; margin:0 auto; padding:80px 16px; text-align:center}
    #thanks .box{background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:40px; box-shadow:0 8px 24px rgba(0,0,0,.06)}
    #thanks h1{font-size:28px; margin:0 0 8px}
    #thanks p{margin:4px 0 20px}
    #thanks a{color:#e11d48; text-decoration:none; font-weight:600}
  </style>
</head>
<body>
  <header id="siteHeader">
    <div class="wrap">
      <h1><strong>宗教相性診断フォーム</strong></h1>
      <p class="lead">あなたの世界観・死生観・信仰スタイルから、思想タイプの相性を推定します。※このページはブラウザ内で完結します。</p>
    </div>
  </header>

  <main class="wrap" id="siteMain">
    <section class="card">
      <div class="row">
        <label for="nickname">こちらにお名前やニックネームなどを記入してください</label>
        <input id="nickname" type="text" placeholder="例：喪黒 福造 / 匿名でも可" />
      </div>
    </section>

    <section class="card">
      <h2 style="margin:0 0 12px; font-size:18px">設問（全50問・プルダウンで選択）</h2>
      <div id="qgrid" class="grid"></div>
    </section>

    <section class="card">
      <div class="actions">
        <button class="btn primary" id="submitBtn">診断結果送信</button>
      </div>
      <p style="color:var(--muted); font-size:13px">各設問のプルダウンから「はい／どちらでもない／いいえ」を選んでください。</p>
    </section>
  </main>

  <!-- Thanks page -->
  <div id="thanks">
    <div class="center">
      <div class="box">
        <h1>ありがとうございます！</h1>
        <p>送信が無事に完了しました。</p>
        <p><a id="backLink" href="#">サイトに戻る</a></p>
      </div>
      <p style="margin-top:18px; color:#6b7280; font-size:13px">（静的サイトから送信）</p>
    </div>
  </div>

  <script>
    // 送信先
    const MAIL_TO = 'mnrngym@yahoo.co.jp';
    // まず FormSubmit に JSON で投げる。ダメなら mailto へフォールバック
    const FORMSUBMIT_ENDPOINT = 'https://formsubmit.co/ajax/' + encodeURIComponent(MAIL_TO);

    // 50問（1〜50）
    const Q = [
      [1,"宇宙は偶然ではなく、何らかの意志（神や法則）によって創造されたと思う。"],
      [2,"世界には人間の理解を超えた秩序が存在すると思う。"],
      [3,"善と悪は時代や文化を超えて存在すると思う。"],
      [4,"宇宙や自然は、単なる物質ではなく『生きている』ような存在だと思う。"],
      [5,"物事は偶然ではなく必然的に起こることが多いと思う。"],
      [6,"すべての出来事には意味があると思う。"],
      [7,"自然や宇宙そのものが神聖だと思う。"],
      [8,"宇宙は有限ではなく、永遠に続くと思う。"],
      [9,"世界には見えないエネルギーや波動があると思う。"],
      [10,"この世界は『試練の場』であり、人は成長するためにここにいると思う。"],
      [11,"神（または神に相当する存在）は人格を持ち、意思や感情があると思う。"],
      [12,"神は人間を愛しており、正しい道へ導こうとしていると思う。"],
      [13,"神は唯一であり、他の神は存在しないと思う。"],
      [14,"世界には複数の神や霊的存在がいると思う。"],
      [15,"神は善悪を裁き、報いを与えると思う。"],
      [16,"神や高次の存在は、祈りや儀式を通して人間と交流できると思う。"],
      [17,"神は超越的存在であり、人間の姿や性質とは全く異なると思う。"],
      [18,"神は人間の行動だけでなく心の内も見ていると思う。"],
      [19,"神の意志は聖典や啓示によって人類に伝えられていると思う。"],
      [20,"神は存在するが、人間の理解を超えていて定義できないと思う。"],
      [21,"死後に天国や地獄のような行き先があると思う。"],
      [22,"死後は生前の行いによって行き先が決まると思う。"],
      [23,"人は死後に別の肉体に生まれ変わると思う。"],
      [24,"輪廻転生は人間だけでなく動物や他の存在にも当てはまると思う。"],
      [25,"死後は霊的な世界で家族や知人と再会できると思う。"],
      [26,"死後は個としての意識は失われ、宇宙や全体に溶けると思う。"],
      [27,"死後の世界は地上世界とは全く異なる次元にあると思う。"],
      [28,"死後の行き先は自分で選べると思う。"],
      [29,"死は終わりではなく、別の段階への移行だと思う。"],
      [30,"死後の世界は存在しないと思う。"],
      [31,"人生にはあらかじめ意味や使命が与えられていると思う。"],
      [32,"人生の目的は徳や善行を積むことだと思う。"],
      [33,"人生は神や宇宙から与えられた学びの場だと思う。"],
      [34,"人生は苦しみと修行の連続であり、それを乗り越えることが重要だと思う。"],
      [35,"人生の目的は悟りや解脱のような境地に到達することだと思う。"],
      [36,"人生の目的は他者への奉仕や愛の実践だと思う。"],
      [37,"人生は偶然の連続であり、特に意味はないと思う。"],
      [38,"人生の価値は自分自身で作り出すものだと思う。"],
      [39,"幸福は神や宇宙との調和の中にあると思う。"],
      [40,"幸福は物質的な満足よりも精神的な充実によって得られると思う。"],
      [41,"定期的な礼拝や儀式に参加することを大切に思う。"],
      [42,"瞑想や内省による精神修養を重視する。"],
      [43,"断食や戒律のような自己規律を重視する。"],
      [44,"聖典や経典を学び、生活に生かすことを大切に思う。"],
      [45,"他者への慈善や奉仕活動を信仰の一部だと思う。"],
      [46,"特定の聖地や神聖な場所を訪れることを大切に思う。"],
      [47,"音楽・歌・踊りなど芸術的表現を通じて神や宇宙とつながることができると思う。"],
      [48,"精霊や先祖との交流（祭祀・祈り）を大切に思う。"],
      [49,"宗教行事や祭りは共同体を維持するために重要だと思う。"],
      [50,"個人的な祈りや瞑想だけで十分であり、組織や集団は不要だと思う。"]
    ];

    // 描画
    const grid = document.getElementById('qgrid');
    function makeSelect(){ 
      const s = document.createElement('select');
      s.innerHTML = `
        <option value="" selected>選択してください</option>
        <option value="はい">はい</option>
        <option value="どちらでもない">どちらでもない</option>
        <option value="いいえ">いいえ</option>
      `;
      return s;
    }
    Q.forEach(([id, text])=>{
      const wrap = document.createElement('div');
      wrap.className='q';
      const h = document.createElement('h4');
      h.textContent = `${id}. ${text}`;
      wrap.appendChild(h);
      const sel = makeSelect();
      sel.id = `q${id}`;
      wrap.appendChild(sel);
      grid.appendChild(wrap);
    });

    // 送信 → サンクス画面
    function showThanks(){
      document.getElementById('siteHeader').style.display='none';
      document.getElementById('siteMain').style.display='none';
      const t = document.getElementById('thanks');
      t.style.display='block';
      const back = document.getElementById('backLink');
      back.href = location.origin + location.pathname;
    }

    document.getElementById('submitBtn').addEventListener('click', async ()=>{
      const name = document.getElementById('nickname').value || '';
      const lines = [];
      lines.push(`名前/ニックネーム: ${name}`);
      for(const [id, text] of Q){
        const v = document.getElementById('q'+id).value || '未回答';
        lines.push(`${id}. ${text} -> ${v}`);
      }
      const bodyText = lines.join('\n');

      // 1) FormSubmitにPOST（動けば自動送信）
      let sent = false;
      try{
        const res = await fetch(FORMSUBMIT_ENDPOINT,{
          method:'POST',
          headers:{'Content-Type':'application/json','Accept':'application/json'},
          body: JSON.stringify({
            _subject:'宗教相性診断フォーム 送信',
            message: bodyText
          })
        });
        if(res.ok){ sent = true; }
      }catch(e){ /* フォールバックへ */ }

      // 2) 失敗時は mailto でメーラーを開く
      if(!sent){
        const subject = encodeURIComponent('宗教相性診断フォーム 送信');
        const body = encodeURIComponent(bodyText + '\n\n(静的サイトから送信)');
        window.location.href = `mailto:${encodeURIComponent(MAIL_TO)}?subject=${subject}&body=${body}`;
      }

      // サンクス画面表示
      setTimeout(showThanks, 600);
    });

    // 直接 ?thanks=1 で開いた場合もサンクス表示
    if(new URLSearchParams(location.search).get('thanks')==='1'){ showThanks(); }
  </script>
</body>
</html>
